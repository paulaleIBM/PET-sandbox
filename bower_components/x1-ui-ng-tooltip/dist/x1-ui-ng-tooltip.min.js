angular.module("x1.ui.tooltip",["pascalprecht.translate","ui.bootstrap.tooltip"]);
angular.module("x1.ui.tooltip").constant("tooltipDefaults",{animation:!1,prefixClass:"tooltip",prefixEvent:"tooltip",container:!1,target:!1,placement:"top",template:"tooltip/tooltip.html",contentTemplate:!1,trigger:"hover focus",keyboard:!1,html:!1,show:!1,title:"",type:"",delay:0,closeIcon:"true"});
angular.module("x1.ui.tooltip").directive("x1Tooltip",["$window","$location","$sce","$x1tooltip","$$rAF",function($window,$location,$sce,$x1tooltip,$$rAF){"use strict";return{restrict:"EAC",scope:!0,link:function(scope,element,attr){var options={scope:scope};angular.forEach(["template","contentTemplate","placement","container","target","delay","trigger","keyboard","html","animation","type","closeIcon","prefixClass","outsideClick"],function(key){angular.isDefined(attr[key])&&(options[key]=attr[key])});var tooltip=$x1tooltip(element,options);angular.forEach(["title"],function(key){attr[key]&&attr.$observe(key,function(newValue,oldValue){scope[key]=$sce.trustAsHtml(newValue),angular.isDefined(oldValue)&&$$rAF(function(){tooltip&&tooltip.$applyPlacement()})})}),attr.x1Tooltip&&scope.$watch(attr.x1Tooltip,function(newValue,oldValue){angular.isObject(newValue)?angular.extend(scope,newValue):scope.title=newValue,angular.isDefined(oldValue)&&$$rAF(function(){tooltip&&tooltip.$applyPlacement()})},!0),attr.toggle&&scope.$on(attr.toggle,function(event,toggle){toggle?tooltip.$scope.$show():tooltip.$scope.$hide()}),scope.close=function(){tooltip.$scope.$hide()},scope.$on("$destroy",function(){tooltip.destroy(),options=null,tooltip=null})}}}]);
angular.module("x1.ui.tooltip").provider("$x1tooltip",["tooltipDefaults",function(tooltipDefaults){"use strict";var defaults=this.defaults=tooltipDefaults;this.$get=["$window","$document","$rootScope","$compile","$q","$templateCache","$http","$animate","tooltipDimensions","$$rAF",function($window,$document,$rootScope,$compile,$q,$templateCache,$http,$animate,tooltipDimensions,$$rAF){function tooltipFactory(element,config){function isTargetOutsideTooltip(event){var tooltipElement=tipElement[0],isInDOM=$document[0].body.contains(event.target),isOutside=tooltipElement&&!tooltipElement.contains(event.target);return isOutside&&isInDOM}function checkTrigger(event){return"manual"===options.trigger||!element[0].contains(event.target)}function handleClick(event){tipElement&&isTargetOutsideTooltip(event)&&checkTrigger(event)&&$tooltip.leave()}function setTooltipPosition(tipPosition,elementPosition,position,arrow,rightPosition){tipElement.css(tipPosition);var arrowStyles,tipOffsetPosition={top:tipElement[0].offsetTop,left:tipElement[0].offsetLeft};arrowStyles=rightPosition?{right:getTipArrowRightPosition(elementPosition)+"px",left:"auto"}:{left:getTipArrowLeftPosition(elementPosition,tipOffsetPosition,position)+"px"},angular.element(arrow).css(arrowStyles)}function getTooltipNodeName(){var nodeElement;return nodeElement=element[0]||element,"string"!=typeof nodeElement?nodeElement.nodeName.toLowerCase():element.toLowerCase()}function getTooltipOptions(){var options;return options=$tooltip.$options=angular.extend({},defaults,config)}function getTooltipScope(){var scope;return scope=$tooltip.$scope=options.scope&&options.scope.$new()||$rootScope.$new()}function getPosition(){var target=options.target||element[0],targetOffset=tooltipDimensions.offset(target);if("body"===options.container)return targetOffset;var targetPosition=tooltipDimensions.position(target);if(!options.container)return targetPosition;var containerOffset=tooltipDimensions.offset(tipContainer[0]);return{height:targetPosition.height,width:targetPosition.width,top:targetOffset.top-containerOffset.top,left:targetOffset.left-containerOffset.left}}function calcPositions(split,position,actualHeight,actualWidth,documentWidth){var offset;switch(split[0]){case"right":offset={top:position.top+position.height/2-actualHeight/2,left:position.left+position.width};break;case"bottom":var leftPosition=position.left+position.width/2-actualWidth/2,totalWidth=leftPosition+actualWidth;totalWidth>documentWidth&&(leftPosition-=totalWidth-documentWidth+5),offset={top:position.top+position.height,left:leftPosition>=0?leftPosition:5};break;case"left":offset={top:position.top+position.height/2-actualHeight/2,left:position.left-actualWidth};break;default:offset={top:position.top-actualHeight,left:position.left+position.width/2-actualWidth/2}}return offset}function calcSpecificPositions(split,offset,position,actualWidth,actualHeight,arrowWidth){function calcTopBottom(){switch(split[1]){case"left":position.width<arrowWidth?offset.left=position.left-actualWidth+arrowWidth+position.width:offset.left=position.left+position.width-actualWidth;break;case"right":position.width<arrowWidth?offset.left=position.left-position.width:offset.left=position.left}}function calcLeftRight(){switch(split[1]){case"top":offset.top=position.top-actualHeight;break;case"bottom":offset.top=position.top+position.height}}"top"===split[0]||"bottom"===split[0]?calcTopBottom():"left"!==split[0]&&"right"!==split[0]||calcLeftRight()}function geOffset(placement,position,actualWidth,actualHeight,arrowWidth){var split=placement.split("-"),documentWidth=document.body.offsetWidth,offset=calcPositions(split,position,actualHeight,actualWidth,documentWidth);return split[1]?(calcSpecificPositions(split,offset,position,actualWidth,actualHeight,arrowWidth),offset):offset}function getTipArrowLeftPosition(elementPosition,tipPosition,position){var tipArrowLeftPosition,borderLeftWidth;return"left"===position?(borderLeftWidth=parseFloat(tooltipDimensions.css(tipElement[0],"borderLeftWidth")),tipArrowLeftPosition=elementPosition.left-tipPosition.left-(borderLeftWidth?borderLeftWidth:0)):"bottom"!==position&&"top"!==position||(tipArrowLeftPosition=elementPosition.left+elementPosition.width/2-tipPosition.left),tipArrowLeftPosition}function getTipArrowRightPosition(elementPosition){return window.innerWidth-elementPosition.left-elementPosition.width/2-ARROW_WIDTH}function checkElOffScreenY(tipElement,tipPosition,tipHeight,tipHeader,tipContent){var wrapperHeight,calculatedHeight,top,marginTop,PADDING_BOTTOM_FROM_EDGE;PADDING_BOTTOM_FROM_EDGE=10,marginTop=parseFloat(tipElement.css("margin-top"))||0,top=tipPosition.top+marginTop+PADDING_BOTTOM_FROM_EDGE,wrapperHeight=window.innerHeight,"body"===options.container&&(top-=window.pageYOffset),top+tipHeight>wrapperHeight?(calculatedHeight=wrapperHeight-top-tipHeader.prop("offsetHeight"),tipContent.css("height",calculatedHeight+"px")):tipContent.css("height","auto")}function checkTipOffScreenX(tipPosition,elementPosition,position,arrow){function setupTooltipBoundaries(){tipElementRects.left<=0&&(tipPosition.left=tipIndentFromEdge+"px"),tipElementRects.right>=window.innerWidth&&(tipPosition.left="",tipPosition.right=margin+"px"),!isNaN(offsetLeft)&&margin>=tipWidth?(tipPosition.left="auto",tipPosition.right=margin+"px",rightPosition=!0):(tipPosition.right="auto",rightPosition=!1)}function checkBackToFullScreen(){containerInitialPositions.initialized||(containerInitialPositions.left=tipPosition.left,containerInitialPositions.right=tipPosition.right?tipPosition.right:"",containerInitialPositions.initialized=!0)}var canProceed=tipElement[0].getClientRects()[0]&&("bottom"===position||"top"===position);if(canProceed){tipElement[0].style.right=null;var tipIndentFromEdge=5,margin=SCROLL_WIDTH+tipIndentFromEdge,offsetLeft=parseInt(tipElement[0].style.left),tipElementRects=tipElement[0].getClientRects()[0],tipWidth=Math.floor(window.innerWidth-tipElementRects.width-offsetLeft),rightPosition=!1;setupTooltipBoundaries(),checkBackToFullScreen(),setTooltipPosition(tipPosition,elementPosition,position,arrow,rightPosition)}}var nodeName,options,scope,timeout,hoverState,tipLinker,tipElement,tipTemplate,tipContainer,$tooltip={},containerInitialPositions={initialized:!1};nodeName=getTooltipNodeName(),options=getTooltipOptions(),scope=getTooltipScope(),$tooltip.$promise=fetchTemplate(options.template),options.delay&&angular.isString(options.delay)&&(options.delay=parseFloat(options.delay)),options.title&&($tooltip.$scope.title=options.title),options.closeIcon&&($tooltip.$scope.closeIcon="true"===$tooltip.$options.closeIcon),scope.$hide=function(){scope.$$postDigest(function(){$tooltip.hide()})},scope.$show=function(){scope.$$postDigest(function(){$tooltip.show()})},scope.$toggle=function(){scope.$$postDigest(function(){$tooltip.toggle()})},$tooltip.$isShown=scope.$isShown=!1,options.contentTemplate&&($tooltip.$promise=$tooltip.$promise.then(function(template){var templateEl=angular.element(template);return fetchTemplate(options.contentTemplate).then(function(contentTemplate){var contentEl=findElement("[ng-bind='content'], [ng-bind-html='content']",templateEl[0]);return contentEl.length||(contentEl=findElement("[ng-bind='title'], [ng-bind-html='title']",templateEl[0])),contentEl[0]&&(contentEl[0].removeAttribute("ng-bind-html"),contentEl[0].removeAttribute("ng-bind")),angular.element(contentEl).html(contentTemplate),templateEl[0].outerHTML})})),$tooltip.$promise.then(function(template){angular.isObject(template)&&(template=template.data),options.html&&(template=template.replace(htmlReplaceRegExp,'ng-bind-html="')),template=trim.apply(template),tipTemplate=template,tipLinker=$compile(template),$tooltip.init()}),$tooltip.init=function(){options.delay&&angular.isNumber(options.delay)&&(options.delay={show:options.delay,hide:options.delay}),"self"===options.container?tipContainer=element:options.container&&(tipContainer=angular.isElement(options.container)?options.container:findElement(options.container));var triggers=options.trigger.split(" ");angular.forEach(triggers,function(trigger){if("string"!=typeof element){var wrElement=angular.element(element);"click"===trigger?wrElement.on("click",$tooltip.toggle):"manual"!==trigger&&(wrElement.on("hover"===trigger?"mouseenter":"focus",$tooltip.enter),wrElement.on("hover"===trigger?"mouseleave":"blur",$tooltip.leave),"button"===nodeName&&"hover"!==trigger&&wrElement.on(isTouch?"touchstart":"mousedown",$tooltip.$onFocusElementMouseDown),$tooltip.$scope.closeIcon=!1)}}),options.target&&(options.target=angular.isElement(options.target)?options.target:findElement(options.target)[0]),options.show&&scope.$$postDigest(function(){"focus"===options.trigger?element[0].focus():$tooltip.show()})},$tooltip.destroy=function(){for(var triggers=options.trigger.split(" "),i=triggers.length;i--;){var trigger=triggers[i];"click"===trigger?element.off("click",$tooltip.toggle):"manual"!==trigger&&(element.off("hover"===trigger?"mouseenter":"focus",$tooltip.enter),element.off("hover"===trigger?"mouseleave":"blur",$tooltip.leave),"button"===nodeName&&"hover"!==trigger&&element.off(isTouch?"touchstart":"mousedown",$tooltip.$onFocusElementMouseDown))}tipElement&&(tipElement.remove(),tipElement=null),clearTimeout(timeout),scope.$destroy()},$tooltip.enter=function(){return clearTimeout(timeout),hoverState="in",options.delay&&options.delay.show?void(timeout=setTimeout(function(){"in"===hoverState&&$tooltip.show()},options.delay.show)):$tooltip.show()};var bindEvents=function(){options.keyboard&&("focus"!==options.trigger?($tooltip.focus(),tipElement.on("keyup",$tooltip.$onKeyUp)):element.on("keyup",$tooltip.$onFocusKeyUp)),options.outsideClick&&$document[0].addEventListener("click",handleClick,!0)};$tooltip.show=function(){scope.$emit(options.prefixEvent+".show.before",$tooltip);var parent=options.container?tipContainer:null,after=options.container?null:element;tipElement&&tipElement.remove(),tipElement=$tooltip.$element=tipLinker(scope,function(){}),tipElement.css({top:"-9999px",left:"-9999px",display:"block"}).addClass(options.placement),options.animation&&tipElement.addClass(options.animation),options.type&&tipElement.addClass(options.prefixClass+"-"+options.type),$animate.enter(tipElement,angular.element(parent),after,function(){scope.$emit(options.prefixEvent+".show",$tooltip)}),$tooltip.$isShown=scope.$isShown=!0,scope.$$phase||scope.$root&&scope.$root.$$phase||scope.$digest(),$$rAF($tooltip.$applyPlacement),bindEvents()},$tooltip.leave=function(){return clearTimeout(timeout),hoverState="out",options.delay&&options.delay.hide?void(timeout=setTimeout(function(){"out"===hoverState&&$tooltip.hide()},options.delay.hide)):$tooltip.hide()};var unbindEvents=function(){options.keyboard&&null!==tipElement&&tipElement.off("keyup",$tooltip.$onKeyUp),$document[0].removeEventListener("click",handleClick,!0)};return $tooltip.hide=function(blur){return $tooltip.$isShown?(scope.$emit(options.prefixEvent+".hide.before",$tooltip),tipElement?$animate.leave(tipElement,function(){scope.$emit(options.prefixEvent+".hide",$tooltip)}):$tooltip.destroy(),$tooltip.$isShown=scope.$isShown=!1,scope.$$phase||scope.$root&&scope.$root.$$phase||scope.$digest(),unbindEvents(),blur&&"focus"===options.trigger?element[0].blur():void 0):void 0},$tooltip.toggle=function(){$tooltip.$isShown?$tooltip.leave():$tooltip.enter()},$tooltip.focus=function(){tipElement[0].focus()},$tooltip.$applyPlacement=function(){if(tipElement){var arrow=angular.element(tipElement.children()[0]),elementPosition=getPosition(),tipContent=tipElement.find(".popover-content"),tipHeader=tipElement.find(".popover-header");tipContent.css("height","auto");var tipWidth=tipElement.prop("offsetWidth"),tipHeight=tipElement.prop("offsetHeight"),navTop=element[0].offsetHeight+element[0].offsetTop,tipPosition=geOffset(options.placement,elementPosition,tipWidth,tipHeight,arrow[0].offsetWidth);"bottom"===options.placement.split("-")[0]&&tipPosition.top<0&&(tipPosition.top=navTop);var position=options.placement.split("-")[0],tipArrowLeftPosition=getTipArrowLeftPosition(elementPosition,tipPosition,position);checkElOffScreenY(tipElement,tipPosition,tipHeight,tipHeader,tipContent),window.innerWidth<tipPosition.left+tipWidth+SCROLL_WIDTH&&(tipPosition.left-=SCROLL_WIDTH,tipArrowLeftPosition+=SCROLL_WIDTH),tipPosition.top+="px",tipPosition.left+="px",tipElement.css(tipPosition),"body"===options.container&&"bottom"===options.placement.split("-")[0]&&tipElement.css("top",elementPosition.top+elementPosition.height+"px"),angular.element(arrow).css({left:tipArrowLeftPosition+"px"}),checkTipOffScreenX(tipPosition,elementPosition,position,arrow)}},$tooltip.$onKeyUp=function(evt){27===evt.which&&$tooltip.hide()},$tooltip.$onFocusKeyUp=function(evt){27===evt.which&&element[0].blur()},$tooltip.$onFocusElementMouseDown=function(evt){evt.preventDefault(),evt.stopPropagation(),$tooltip.$isShown?element[0].blur():element[0].focus()},$tooltip}function findElement(query,element){return angular.element((element||document).querySelectorAll(query))}function fetchTemplate(template){return $q.when($templateCache.get(template)||$http.get(template)).then(function(res){return angular.isObject(res)?($templateCache.put(template,res.data),res.data):res})}var trim=String.prototype.trim,isTouch="createTouch"in $window.document,htmlReplaceRegExp=/ng-bind="/gi,SCROLL_WIDTH=15,ARROW_WIDTH=22;return tooltipFactory}]}]);
angular.module("x1.ui.tooltip").factory("tooltipDimensions",[function(){"use strict";var fn={},nodeName=fn.nodeName=function(element,name){return element.nodeName&&element.nodeName.toLowerCase()===name.toLowerCase()};fn.css=function(element,prop,extra){var value;return value=element.currentStyle?element.currentStyle[prop]:window.getComputedStyle?window.getComputedStyle(element)[prop]:element.style[prop],extra?parseFloat(value)||0:value},fn.offset=function(element){var boxRect=element.getBoundingClientRect(),docElement=element.ownerDocument,calcWidth=boxRect.width||element.offsetWidth,calcHeight=boxRect.height||element.offsetHeight,calcTop=boxRect.top+(window.pageYOffset||docElement.documentElement.scrollTop)-(docElement.documentElement.clientTop||0),calcLeft=boxRect.left+(window.pageXOffset||docElement.documentElement.scrollLeft)-(docElement.documentElement.clientLeft||0);return{width:calcWidth,height:calcHeight,top:calcTop,left:calcLeft}};var offsetParent=function(element){var docElement=element.ownerDocument,offsetParent=element.offsetParent||docElement;if(nodeName(offsetParent,"#document"))return docElement.documentElement;for(;offsetParent&&!nodeName(offsetParent,"html")&&"static"===fn.css(offsetParent,"position");)offsetParent=offsetParent.offsetParent;return offsetParent||docElement.documentElement};return fn.position=function(element){var offsetParentElement,offset,offsetParentRect={top:0,left:0};return"fixed"===fn.css(element,"position")?offset=element.getBoundingClientRect():(offsetParentElement=offsetParent(element),offset=fn.offset(element),nodeName(offsetParentElement,"html")||(offsetParentRect=fn.offset(offsetParentElement)),offsetParentRect.top+=fn.css(offsetParentElement,"borderTopWidth",!0),offsetParentRect.left+=fn.css(offsetParentElement,"borderLeftWidth",!0)),{width:element.offsetWidth,height:element.offsetHeight,top:offset.top-offsetParentRect.top,left:offset.left-offsetParentRect.left}},fn.height=function(element,outer){var value=element.offsetHeight;return outer?value+=fn.css(element,"marginTop",!0)+fn.css(element,"marginBottom",!0):value-=fn.css(element,"paddingTop",!0)+fn.css(element,"paddingBottom",!0)+fn.css(element,"borderTopWidth",!0)+fn.css(element,"borderBottomWidth",!0),value},fn.width=function(element,outer){var value=element.offsetWidth;return outer?value+=fn.css(element,"marginLeft",!0)+fn.css(element,"marginRight",!0):value-=fn.css(element,"paddingLeft",!0)+fn.css(element,"paddingRight",!0)+fn.css(element,"borderLeftWidth",!0)+fn.css(element,"borderRightWidth",!0),value},fn}]);
!function(module){try{module=angular.module("x1.ui.tooltip")}catch(e){module=angular.module("x1.ui.tooltip",[])}module.run(["$templateCache",function($templateCache){$templateCache.put("tooltip/tooltip.html",'<div ng-show="title" role="tooltip" class="x1-ui-tooltip tooltip in"><div class="tooltip-arrow" aria-hidden="true"></div><div class="tooltip-inner" ng-class="{\'closable\': closeIcon}" ng-bind-html="title"></div><button ng-if="closeIcon" type="button" class="close" ng-click="close()" tabindex="0" name="tooltipCloseIcon" aria-label="{\'x1UiNgTooltip.CLOSE\' | translate}"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></button></div>')}])}();